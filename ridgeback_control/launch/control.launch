<launch>
  <arg name="robot_namespace" default="r0"/>
  <!-- Generate the tf_prefix from the namespace -->
  <arg name="tfpre" default="$(arg robot_namespace)_tf" />
  <!-- Put value on the parameter server in the group's namespace -->
  <param name="tf_prefix" value="$(arg robot_namespace)_tf" />

  <rosparam command="load" file="$(find ridgeback_control)/config/control.yaml" />
  <rosparam param="ridgeback_velocity_controller/base_frame_id" subst_value="True">$(arg tfpre)/base_link</rosparam>
  <rosparam param="ridgeback_velocity_controller/odom_frame_id" subst_value="True">$(arg tfpre)/odom</rosparam>
 
  <group if="$(optenv RIDGEBACK_CONTROL_EXTRAS 0)" >
    <rosparam command="load" file="$(env RIDGEBACK_CONTROL_EXTRAS_PATH)" />
  </group>

  <node name="controller_spawner" pkg="controller_manager" type="spawner"
        args="ridgeback_joint_publisher ridgeback_velocity_controller" />

  <!-- ekf localization temporarily disabled
   <node pkg="robot_localization_243" type="ekf_localization_node" name="ekf_localization">
        <rosparam param="base_link_frame" subst_value="True">base_link</rosparam>
  </node>-->

  <node pkg="topic_tools" type="relay" name="cmd_vel_relay"
        args="cmd_vel ridgeback_velocity_controller/cmd_vel" />
</launch>
